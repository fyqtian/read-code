**B树和B+树的区别**



https://segmentfault.com/a/1190000020416577 

https://zhuanlan.zhihu.com/p/27700617

#### B树概念

B树也称B-树,它是一颗多路平衡查找树。二叉树我想大家都不陌生，其实，B树和后面讲到的B+树也是从最简单的二叉树变换而来的，并没有什么神秘的地方，下面我们来看看B树的定义。

```
B树的类型与节点定义
struct BTNode
{
	int keyNum ; //实际关键字的个数
	PBTNode parent；//指向父亲节点
	PBTNode *ptr ;
	keyType *key ； //关键字向量
}
```

m指一个节点有多少个孩子

- 每个节点最多有m-1个**关键字**（可以存有的键值对）。
- 根节点最少可以只有1个**关键字**。
- 非根节点至少有m/2个**关键字**。
- 每个节点中的关键字都按照从**小到大的顺序排列**，**每个关键字的左子树中的所有关键字都小于它，而右子树中的所有关键字都大于它。**
- 所有叶子节点都位于同一层，或者说根节点到每个叶子节点的长度都相同。
- **每个节点都存有索引和数据**，也就是对应的key和value。



所以，根节点的**关键字**数量范围：`1 <= k <= m-1`，非根节点的**关键字**数量范围：`m/2 <= k <= m-1`。

另外，我们需要注意一个概念，描述一颗B树时需要指定它的阶数，阶数表示了一个节点最多有多少个孩子节点，一般用字母m表示阶数。

我们再举个例子来说明一下上面的概念比如这里有一个5阶的B树，**根节点数量范围：1 <= k <= 4，非根节点数量范围：2 <= k <= 4。**

**判断当前结点key的个数是否小于等于m-1，如果满足，直接插入即可，如果不满足，将节点的中间的key将这个节点分为左右两部分，中间的节点放到父节点中即可**



#### 2.1 B+树概述

B+树其实和B树是非常相似的，我们首先看看**相同点**。

- 根节点至少一个元素
- 非根节点元素范围：m/2 <= k <= m-1

B树**每个节点都存储数据**，所有节点组成这棵树。B+树**只有叶子节点存储数据**（B+数中有两个头指针：一个指向根节点，另一个指向关键字最小的叶节点），叶子节点包含了这棵树的所有数据，**所有的叶子结点使用链表相连，便于区间查找和遍历**，所有非叶节点起到索引作用。

B树中叶节点包含的关键字和其他节点包含的关键字是不重复的，B+树的索引项只包含对应子树的最大关键字和指向该子树的指针，不含有该关键字对应记录的存储地址。

B树中每个节点（非根节点）关键字个数的范围为[m/2(向上取整)-1,m-1](根节点为[1,m-1])，并且具有n个关键字的节点包含（n+1）棵子树。B+树中每个节点（非根节点）关键字个数的范围为[m/2(向上取整),m](根节点为[1,m])，具有n个关键字的节点包含（n）棵子树。

**不同点**。

- B+树有两种类型的节点：**内部结点（也称索引结点）和叶子结点**。**内部节点就是非叶子节点**，内部节点不存储数据，只存储索引，数据都存储在叶子节点。 
- 内部结点中的key都按照从小到大的顺序排列，对于内部结点中的一个key，左树中的所有key都小于它，右子树中的key都大于等于它。叶子结点中的记录也按照key的大小排列。
- 每个叶子结点都存有相邻叶子结点的指针，叶子结点本身依关键字的大小自小而大顺序链接。
- **父节点存有右孩子的第一个元素的索**引。

1. b+树的中间节点不保存数据，能容纳更多节点元素。 **(一个数据页存放的数据更多 IO减少)**







### B树和B+树总结

B+树相对于B树有一些自己的优势，可以归结为下面几点。

- **单一节点存储的元素更多，使得查询的IO次数更少**，所以也就使得它更适合做为数据库MySQL的底层数据结构了。
- 所有的查询都要查找到叶子节点，**查询性能是稳定的**，**而B树，每个节点都可以查找到数据**，所以不稳定。
- 所有的叶子节点形成了一个有序链表，更加便于查找。